<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Document</title>
</head>

<body>
   <!-- 添加一个按钮用于触发请求 -->
   <button id="convertBtn" style="padding: 10px 20px; font-size: 16px; cursor: pointer;">
      转换并打开 OFD 文件
   </button>

   <script src="./plugs/jquery-1.9.1.min.js"></script>
   <script>

      // 控件 的一些接口
      // console.log(ctl.SelectionXml(true)) 选择文档 对应的xml 文档数据
      // console.log(ctl.GetXmlContent()) // 完整的 xml 文档数据
      // ctl.SetDocumentParameterValueXml('EMR_Patients','<a><Name333>2222</Name333></a>') xml 数据方式设置 参数值 后面必须
      // var result = ctl.WriteDataFromDataSourceToDocument(); // 从数据源写入数据到文档
      // 可是我们并不需要 编辑器 以上都必须通过编辑器 调用 wasm 方法

      // 添加 XML 映射处理函数
      function mapJsonToXml(jsonData, xmlString) {
         // 解析 XML 字符串到 DOM
         const parser = new DOMParser();
         const xmlDoc = parser.parseFromString(xmlString, 'text/xml');
         // 查找所有带有 ValueBinding 的 XInputField 元素
         // 正确的子元素选择方式
         // 方法1：先获取所有Element，再筛选包含ValueBinding子元素的
         const allElements = xmlDoc.querySelectorAll('Element');
         const inputFields = Array.from(allElements).filter(el => 
            // el.querySelector('ValueBinding') !== null
            Array.from(el.children).some(child => child.tagName === 'ValueBinding')
         );
         inputFields.forEach(field => {
            // 获取数据源和绑定路径
            const dataSource = field.querySelector('DataSource')?.textContent;
            const bindingPath = field.querySelector('BindingPath')?.textContent;

            // 检查是否匹配 EMR_Patients 数据源
            if (dataSource === 'EMR_Patients' && jsonData[bindingPath] !== undefined) {
               const value = jsonData[bindingPath];

               // 更新 XElements 中的 XString.Text
               const xString = field.querySelector('XElements Element[type="XString" ] Text');
               if (xString) {
                  xString.textContent = value;
               } else {
                  // 如果 XElements 结构不存在，创建它
                  const xElements = field.querySelector('XElements') || xmlDoc.createElement('XElements');
                  if (!field.querySelector('XElements')) {
                     // 找到合适的位置插入 XElements
                     const moveFocusEl = field.querySelector('MoveFocusHotKey');
                     if (moveFocusEl) {
                        field.insertBefore(xElements, moveFocusEl);
                     } else {
                        field.appendChild(xElements);
                     }
                  }

                  // 创建 XString 和 Text 元素
                  const element = xmlDoc.createElement('Element');
                  element.setAttribute('xsi:type', 'XString');

                  const textEl = xmlDoc.createElement('Text');
                  textEl.textContent = value;

                  element.appendChild(textEl);
                  xElements.appendChild(element);
               }

               // 更新或创建 InnerValue
               let innerValue = field.querySelector('InnerValue');
               if (innerValue) {
                  innerValue.textContent = value;
               } else {
                  // 如果 InnerValue 不存在，创建它
                  innerValue = xmlDoc.createElement('InnerValue');
                  innerValue.textContent = value;

                  // 找到合适的位置插入 InnerValue
                 // 找到合适的位置插入 InnerValue
                  const nameEl = field.querySelector('Name');
                  const backgroundTextEl = field.querySelector('BackgroundText');

                  // 检查backgroundTextEl是否是field的直接子节点
                  if (backgroundTextEl && backgroundTextEl.parentNode === field) {
                     field.insertBefore(innerValue, backgroundTextEl);
                  } else if (nameEl) {
                     field.insertBefore(innerValue, nameEl.nextSibling);
                  } else {
                     field.appendChild(innerValue);
                  }
               }
            }
         });

         // 将修改后的 DOM 转回字符串
         const serializer = new XMLSerializer();
         return serializer.serializeToString(xmlDoc.documentElement);
      }
      // 将请求逻辑封装成一个函数
      function convertAndOpenOFD() {
         const mappedXml = mapJsonToXml(EMR_Patients_values, strxmldate);
         var data11 = { FileXml: mappedXml };

         // console.log(mappedXml);
         $.ajax({
            url: "http://117.89.85.111:8018/DCWebServiceConvert.asmx/TransOFDToByte",
            data: data11,
            type: "post",
            "headers": {
               "content-type": "application/x-www-form-urlencoded"
            },
            success: function (data) {
               console.log(data);
               var targetXml = data.querySelector("base64Binary").innerHTML;
               var bstr = atob(targetXml), n = bstr.length, u8arr = new Uint8Array(n);
               while (n--) {
                  u8arr[n] = bstr.charCodeAt(n);
               }
               //弹窗显示
               // const file = new File([u8arr], "fileName.ofd", { type: 'font/otf' });
               // const formData = new FormData();
               // let _timeStampStr = new Date().getTime().toString();
               // formData.append('file', file);
               // formData.append('fileName', _timeStampStr);
               // var xhr = new XMLHttpRequest(); // 创建XMLHttpRequest对象
               // xhr.open('POST', 'https://www.dcwriter.cn:8002/saveFile', true);
               // xhr.onload = () => {
               //    if (xhr.status == 200) {
               //       console.log('文件上传成功');
               //    } else {
               //       console.error('文件上传失败');
               //    }
               //    window.open(`https://dcwriter.cn:5053?fileName=${_timeStampStr}`, '_blank');
               // };

               // xhr.send(formData); // 发送请求
            },
            error: function (eer) {
               alert("发送ajax请求失败！");
               console.log(eer);
            }
         });
      }

      // 页面加载完成后，为按钮添加点击事件
      window.onload = function () {
         document.getElementById('convertBtn').addEventListener('click', convertAndOpenOFD);
      }

      // 模拟数据源 EMR_Patients 这个是数据源区别标识 模版中有标识 DataSource 标签指明 当前元素 绑定数据标识
      var EMR_Patients_values = {
         Name: "张三",
         //病人id
         BirthPlace: "112233",
         sex: "女",
         Job: "护士",
         Age: "33",
         // 住院次数
         indate: "2019-3-27",
         //门诊号
         mingzu: "汉族",
         //一卡通号
         recorddate: "2019-3-28",
         //住院号
         marriage: "3333",
         //住院病区号（病室）
         patientname: "004",
      };

      // 模拟摸板 ，将 数据源 绑定到模块（json 的key）

      var strxmldate = `<XTextDocument xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" EditorVersionString="1.2023.4.28">
       <Attributes>
          <Attribute>
             <Name>DCLocalDataSource</Name>
             <Value>&lt;DataSourceDocument xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" ID="DataSource" Name="DataSource" Guid="9c34a38d-a29b-4685-83f9-db43397b4d3a" Title=""&gt;&lt;Parameters /&gt;&lt;Nodes /&gt;&lt;/DataSourceDocument&gt;</Value>
          </Attribute>
       </Attributes>
       <XElements>
          <Element xsi:type="XTextHeader">
             <InnerID>6</InnerID>
             <AcceptTab>true</AcceptTab>
             <XElements>
                <Element xsi:type="XParagraphFlag" StyleIndex="1">
                   <InnerID>7</InnerID>
                </Element>
                <Element xsi:type="XParagraphFlag" StyleIndex="2">
                   <InnerID>8</InnerID>
                </Element>
                <Element xsi:type="XParagraphFlag" StyleIndex="2">
                   <InnerID>9</InnerID>
                </Element>
                <Element xsi:type="XInputField" StyleIndex="4">
                   <InnerID>10</InnerID>
                   <ID>机构名称</ID>
                   <EnableValueValidate>true</EnableValueValidate>
                   <Deleteable>false</Deleteable>
                   <BorderElementColor />
                   <MoveFocusHotKey>Tab</MoveFocusHotKey>
                   <SpecifyWidth>1181.10242</SpecifyWidth>
                   <Alignment>Center</Alignment>
                   <Name>机构名称</Name>
                   <BackgroundText>机构名称</BackgroundText>
                </Element>
                <Element xsi:type="XParagraphFlag" StyleIndex="2">
                   <InnerID>11</InnerID>
                </Element>
                <Element xsi:type="XString">
                   <InnerID>368</InnerID>
                   <Text>科别：</Text>
                </Element>
                <Element xsi:type="XInputField">
                   <InnerID>13</InnerID>
                   <ID>科别</ID>
                   <EnableValueValidate>true</EnableValueValidate>
                   <BorderElementColor />
                   <Name>科别</Name>
                   <BackgroundText>科别</BackgroundText>
                </Element>
                <Element xsi:type="XString">
                   <InnerID>369</InnerID>
                   <Text>     床号：</Text>
                </Element>
                <Element xsi:type="XInputField">
                   <InnerID>15</InnerID>
                   <ID>床号</ID>
                   <EnableValueValidate>true</EnableValueValidate>
                   <BorderElementColor />
                   <Name>床号</Name>
                   <BackgroundText>床号</BackgroundText>
                </Element>
                <Element xsi:type="XString">
                   <InnerID>370</InnerID>
                   <Text>床    姓名：</Text>
                </Element>
                <Element xsi:type="XInputField">
                   <InnerID>17</InnerID>
                   <ID>姓名YM</ID>
                   <EnableValueValidate>true</EnableValueValidate>
                   <BorderElementColor />
                   <Name>姓名</Name>
                   <BackgroundText>姓名</BackgroundText>
                </Element>
                <Element xsi:type="XString" StyleIndex="5">
                   <InnerID>371</InnerID>
                   <Text>    住院号：</Text>
                </Element>
                <Element xsi:type="XInputField" StyleIndex="5">
                   <InnerID>19</InnerID>
                   <ID>住院号</ID>
                   <EnableValueValidate>true</EnableValueValidate>
                   <BorderElementColor />
                   <Name>住院号</Name>
                   <BackgroundText>住院号</BackgroundText>
                </Element>
                <Element xsi:type="XParagraphFlag" StyleIndex="3">
                   <InnerID>20</InnerID>
                </Element>
             </XElements>
          </Element>
          <Element xsi:type="XTextBody">
             <InnerID>21</InnerID>
             <AcceptTab>true</AcceptTab>
             <XElements>
                <Element xsi:type="XString" StyleIndex="6">
                   <InnerID>372</InnerID>
                   <Text>入院记录</Text>
                </Element>
                <Element xsi:type="XParagraphFlag" StyleIndex="10">
                   <InnerID>107</InnerID>
                </Element>
                <Element xsi:type="XTextTable" NumOfRows="6" NumOfColumns="2">
                   <InnerID>109</InnerID>
                   <ID>table1</ID>
                   <XElements>
                      <Element xsi:type="XTextTableRow">
                         <InnerID>112</InnerID>
                         <XElements>
                            <Element xsi:type="XTextTableCell" StyleIndex="7">
                               <InnerID>26</InnerID>
                               <XElements>
                                  <Element xsi:type="XString">
                                     <InnerID>374</InnerID>
                                     <Text> 姓名：</Text>
                                  </Element>
                                  <Element xsi:type="XInputField">
                                     <InnerID>119</InnerID>
                                     <ID>姓名</ID>
                                     <EnableValueValidate>true</EnableValueValidate>
                                     <ValueBinding>
                                        <DataSource>EMR_Patients</DataSource>
                                        <BindingPath>Name</BindingPath>
                                     </ValueBinding>
                                     <BorderElementColor />
                                     <MoveFocusHotKey>Tab</MoveFocusHotKey>
                                     <Name>姓名</Name>
                                     <BackgroundText>姓名</BackgroundText>
                                  </Element>
                                  <Element xsi:type="XParagraphFlag">
                                     <InnerID>123</InnerID>
                                  </Element>
                               </XElements>
                            </Element>
                            <Element xsi:type="XTextTableCell" StyleIndex="7">
                               <InnerID>1</InnerID>
                               <XElements>
                                  <Element xsi:type="XString">
                                     <InnerID>375</InnerID>
                                     <Text>出生地：</Text>
                                  </Element>
                                  <Element xsi:type="XInputField">
                                     <InnerID>130</InnerID>
                                     <ID>出生地</ID>
                                     <EnableValueValidate>true</EnableValueValidate>
                                     <ValueBinding>
                                        <DataSource>EMR_Patients</DataSource>
                                        <BindingPath>BirthPlace</BindingPath>
                                     </ValueBinding>
                                     <BorderElementColor />
                                     <MoveFocusHotKey>Tab</MoveFocusHotKey>
                                     <Name>出生地</Name>
                                     <BackgroundText>出生地</BackgroundText>
                                  </Element>
                                  <Element xsi:type="XParagraphFlag">
                                     <InnerID>137</InnerID>
                                  </Element>
                               </XElements>
                            </Element>
                         </XElements>
                      </Element>
                      <Element xsi:type="XTextTableRow">
                         <InnerID>138</InnerID>
                         <XElements>
                            <Element xsi:type="XTextTableCell" StyleIndex="7">
                               <InnerID>2</InnerID>
                               <XElements>
                                  <Element xsi:type="XString">
                                     <InnerID>376</InnerID>
                                     <Text> 性别：</Text>
                                  </Element>
                                  <Element xsi:type="XInputField">
                                     <InnerID>145</InnerID>
                                     <ID>性别</ID>
                                     <EnableValueValidate>true</EnableValueValidate>
                                     <ValueBinding>
                                        <DataSource>EMR_Patients</DataSource>
                                        <BindingPath>sex</BindingPath>
                                     </ValueBinding>
                                     <BorderElementColor />
                                     <MoveFocusHotKey>Tab</MoveFocusHotKey>
                                     <Name>性别</Name>
                                     <BackgroundText>性别</BackgroundText>
                                     <EditorActiveMode>Program F2 MouseClick</EditorActiveMode>
                                     <FieldSettings>
                                        <EditStyle>DropdownList</EditStyle>
                                        <ListSource>
                                           <Items>
                                              <Item>
                                                 <Text>男</Text>
                                                 <Value>1</Value>
                                              </Item>
                                              <Item>
                                                 <Text>女</Text>
                                                 <Value>2</Value>
                                              </Item>
                                           </Items>
                                        </ListSource>
                                     </FieldSettings>
                                  </Element>
                                  <Element xsi:type="XString" WhitespaceCount="2">
                                     <InnerID>377</InnerID>
                                     <Text>  </Text>
                                  </Element>
                                  <Element xsi:type="XParagraphFlag">
                                     <InnerID>149</InnerID>
                                  </Element>
                               </XElements>
                            </Element>
                            <Element xsi:type="XTextTableCell" StyleIndex="7">
                               <InnerID>3</InnerID>
                               <XElements>
                                  <Element xsi:type="XString">
                                     <InnerID>378</InnerID>
                                     <Text>职业：</Text>
                                  </Element>
                                  <Element xsi:type="XInputField">
                                     <InnerID>155</InnerID>
                                     <ID>职业</ID>
                                     <EnableValueValidate>true</EnableValueValidate>
                                     <ValueBinding>
                                        <DataSource>EMR_Patients</DataSource>
                                        <BindingPath>Job</BindingPath>
                                     </ValueBinding>
                                     <BorderElementColor />
                                     <MoveFocusHotKey>Tab</MoveFocusHotKey>
                                     <Name>职业</Name>
                                     <BackgroundText>职业</BackgroundText>
                                  </Element>
                                  <Element xsi:type="XParagraphFlag">
                                     <InnerID>158</InnerID>
                                  </Element>
                               </XElements>
                            </Element>
                         </XElements>
                      </Element>
                      <Element xsi:type="XTextTableRow">
                         <InnerID>159</InnerID>
                         <XElements>
                            <Element xsi:type="XTextTableCell" StyleIndex="7">
                               <InnerID>4</InnerID>
                               <XElements>
                                  <Element xsi:type="XString">
                                     <InnerID>379</InnerID>
                                     <Text> 年龄：</Text>
                                  </Element>
                                  <Element xsi:type="XInputField">
                                     <InnerID>166</InnerID>
                                     <ID>年龄</ID>
                                     <EnableValueValidate>true</EnableValueValidate>
                                     <ValueBinding>
                                        <DataSource>EMR_Patients</DataSource>
                                        <BindingPath>Age</BindingPath>
                                     </ValueBinding>
                                     <BorderElementColor />
                                     <MoveFocusHotKey>Tab</MoveFocusHotKey>
                                     <Name>年龄</Name>
                                     <BackgroundText>年龄</BackgroundText>
                                     <FieldSettings>
                                        <EditStyle>Numeric</EditStyle>
                                     </FieldSettings>
                                  </Element>
                                  <Element xsi:type="XString">
                                     <InnerID>380</InnerID>
                                     <Text>岁</Text>
                                  </Element>
                                  <Element xsi:type="XParagraphFlag">
                                     <InnerID>170</InnerID>
                                  </Element>
                               </XElements>
                            </Element>
                            <Element xsi:type="XTextTableCell" StyleIndex="7">
                               <InnerID>5</InnerID>
                               <XElements>
                                  <Element xsi:type="XString">
                                     <InnerID>381</InnerID>
                                     <Text>入院时间：</Text>
                                  </Element>
                                  <Element xsi:type="XInputField">
                                     <InnerID>178</InnerID>
                                     <ID>入院时间</ID>
                                     <EnableValueValidate>true</EnableValueValidate>
                                     <ValueBinding>
                                        <DataSource>EMR_Patients</DataSource>
                                        <BindingPath>indate</BindingPath>
                                     </ValueBinding>
                                     <BorderElementColor />
                                     <MoveFocusHotKey>Tab</MoveFocusHotKey>
                                     <Name>入院时间</Name>
                                     <DisplayFormat>
                                        <Style>DateTime</Style>
                                        <Format>yyyy-MM-dd HH:mm:ss</Format>
                                     </DisplayFormat>
                                     <BackgroundText>入院时间</BackgroundText>
                                     <EditorActiveMode>Program F2 MouseClick</EditorActiveMode>
                                     <FieldSettings>
                                        <EditStyle>DateTime</EditStyle>
                                     </FieldSettings>
                                  </Element>
                                  <Element xsi:type="XParagraphFlag">
                                     <InnerID>198</InnerID>
                                  </Element>
                               </XElements>
                            </Element>
                         </XElements>
                      </Element>
                      <Element xsi:type="XTextTableRow">
                         <InnerID>199</InnerID>
                         <XElements>
                            <Element xsi:type="XTextTableCell" StyleIndex="7">
                               <InnerID>6</InnerID>
                               <XElements>
                                  <Element xsi:type="XString">
                                     <InnerID>382</InnerID>
                                     <Text> 民族：</Text>
                                  </Element>
                                  <Element xsi:type="XInputField" StyleIndex="8">
                                     <InnerID>206</InnerID>
                                     <ID>民族</ID>
                                     <EnableValueValidate>true</EnableValueValidate>
                                     <ValueBinding>
                                        <DataSource>EMR_Patients</DataSource>
                                        <BindingPath>mingzu</BindingPath>
                                     </ValueBinding>
                                     <BorderElementColor />
                                     <MoveFocusHotKey>Tab</MoveFocusHotKey>
                                     <Name>民族</Name>
                                     <BackgroundText>民族</BackgroundText>
                                     <EditorActiveMode>Program F2 MouseClick</EditorActiveMode>
                                     <FieldSettings>
                                        <EditStyle>DropdownList</EditStyle>
                                        <ListSource>
                                           <Items>
                                              <Item>
                                                 <Text>汉族</Text>
                                                 <Value>01</Value>
                                              </Item>
                                              <Item>
                                                 <Text>蒙古族</Text>
                                                 <Value>02</Value>
                                              </Item>
                                              <Item>
                                                 <Text>回族</Text>
                                                 <Value>03</Value>
                                              </Item>
                                              <Item>
                                                 <Text>藏族</Text>
                                                 <Value>04</Value>
                                              </Item>
                                              <Item>
                                                 <Text>维吾尔族</Text>
                                                 <Value>05</Value>
                                              </Item>
                                              <Item>
                                                 <Text>苗族</Text>
                                                 <Value>06</Value>
                                              </Item>
                                              <Item>
                                                 <Text>彝族</Text>
                                                 <Value>07</Value>
                                              </Item>
                                              <Item>
                                                 <Text>壮族</Text>
                                                 <Value>08</Value>
                                              </Item>
                                              <Item>
                                                 <Text>布依族</Text>
                                                 <Value>09</Value>
                                              </Item>
                                              <Item>
                                                 <Text>朝鲜族</Text>
                                                 <Value>10</Value>
                                              </Item>
                                              <Item>
                                                 <Text>满族</Text>
                                                 <Value>11</Value>
                                              </Item>
                                              <Item>
                                                 <Text>侗族</Text>
                                                 <Value>12</Value>
                                              </Item>
                                              <Item>
                                                 <Text>瑶族</Text>
                                                 <Value>13</Value>
                                              </Item>
                                              <Item>
                                                 <Text>白族</Text>
                                                 <Value>14</Value>
                                              </Item>
                                              <Item>
                                                 <Text>土家族</Text>
                                                 <Value>15</Value>
                                              </Item>
                                              <Item>
                                                 <Text>哈尼族</Text>
                                                 <Value>16</Value>
                                              </Item>
                                              <Item>
                                                 <Text>哈萨克族</Text>
                                                 <Value>17</Value>
                                              </Item>
                                              <Item>
                                                 <Text>傣族</Text>
                                                 <Value>18</Value>
                                              </Item>
                                              <Item>
                                                 <Text>黎族</Text>
                                                 <Value>19</Value>
                                              </Item>
                                              <Item>
                                                 <Text>傈僳族</Text>
                                                 <Value>20</Value>
                                              </Item>
                                              <Item>
                                                 <Text>佤族</Text>
                                                 <Value>21</Value>
                                              </Item>
                                              <Item>
                                                 <Text>畲族</Text>
                                                 <Value>22</Value>
                                              </Item>
                                           </Items>
                                        </ListSource>
                                     </FieldSettings>
                                  </Element>
                                  <Element xsi:type="XString" StyleIndex="8" WhitespaceCount="1">
                                     <InnerID>383</InnerID>
                                     <Text> </Text>
                                  </Element>
                                  <Element xsi:type="XParagraphFlag">
                                     <InnerID>210</InnerID>
                                  </Element>
                               </XElements>
                            </Element>
                            <Element xsi:type="XTextTableCell" StyleIndex="7">
                               <InnerID>7</InnerID>
                               <XElements>
                                  <Element xsi:type="XString">
                                     <InnerID>384</InnerID>
                                     <Text>记录时间：</Text>
                                  </Element>
                                  <Element xsi:type="XInputField">
                                     <InnerID>218</InnerID>
                                     <ID>记录时间</ID>
                                     <EnableValueValidate>true</EnableValueValidate>
                                     <ValueBinding>
                                        <DataSource>EMR_Patients</DataSource>
                                        <BindingPath>recorddate</BindingPath>
                                     </ValueBinding>
                                     <BorderElementColor />
                                     <MoveFocusHotKey>Tab</MoveFocusHotKey>
                                     <Name>记录时间</Name>
                                     <BackgroundText>记录时间</BackgroundText>
                                     <EditorActiveMode>Program F2 MouseClick</EditorActiveMode>
                                     <FieldSettings>
                                        <EditStyle>DateTime</EditStyle>
                                     </FieldSettings>
                                  </Element>
                                  <Element xsi:type="XParagraphFlag">
                                     <InnerID>228</InnerID>
                                  </Element>
                               </XElements>
                            </Element>
                         </XElements>
                      </Element>
                      <Element xsi:type="XTextTableRow">
                         <InnerID>229</InnerID>
                         <XElements>
                            <Element xsi:type="XTextTableCell" StyleIndex="7">
                               <InnerID>8</InnerID>
                               <XElements>
                                  <Element xsi:type="XString">
                                     <InnerID>385</InnerID>
                                     <Text> 婚姻：</Text>
                                  </Element>
                                  <Element xsi:type="XInputField">
                                     <InnerID>236</InnerID>
                                     <ID>婚姻</ID>
                                     <EnableValueValidate>true</EnableValueValidate>
                                     <ValueBinding>
                                        <DataSource>EMR_Patients</DataSource>
                                        <BindingPath>marriage</BindingPath>
                                     </ValueBinding>
                                     <BorderElementColor />
                                     <MoveFocusHotKey>Tab</MoveFocusHotKey>
                                     <Name>婚姻</Name>
                                     <BackgroundText>婚姻</BackgroundText>
                                     <EditorActiveMode>Program F2 MouseClick</EditorActiveMode>
                                     <FieldSettings>
                                        <EditStyle>DropdownList</EditStyle>
                                        <ListSource>
                                           <Items>
                                              <Item>
                                                 <Text>未婚</Text>
                                                 <Value>0</Value>
                                              </Item>
                                              <Item>
                                                 <Text>已婚</Text>
                                                 <Value>1</Value>
                                              </Item>
                                              <Item>
                                                 <Text>离异</Text>
                                                 <Value>2</Value>
                                              </Item>
                                              <Item>
                                                 <Text>丧偶</Text>
                                                 <Value>3</Value>
                                              </Item>
                                              <Item>
                                                 <Text>其他</Text>
                                                 <Value>4</Value>
                                              </Item>
                                           </Items>
                                        </ListSource>
                                     </FieldSettings>
                                  </Element>
                                  <Element xsi:type="XString" WhitespaceCount="2">
                                     <InnerID>386</InnerID>
                                     <Text>  </Text>
                                  </Element>
                                  <Element xsi:type="XParagraphFlag">
                                     <InnerID>243</InnerID>
                                  </Element>
                               </XElements>
                            </Element>
                            <Element xsi:type="XTextTableCell" StyleIndex="7">
                               <InnerID>9</InnerID>
                               <XElements>
                                  <Element xsi:type="XString">
                                     <InnerID>387</InnerID>
                                     <Text>病史陈述者：</Text>
                                  </Element>
                                  <Element xsi:type="XInputField">
                                     <InnerID>252</InnerID>
                                     <ID>病史陈述者</ID>
                                     <EnableValueValidate>true</EnableValueValidate>
                                     <ValueBinding>
                                        <DataSource>EMR_Patients</DataSource>
                                        <BindingPath>patientname</BindingPath>
                                     </ValueBinding>
                                     <BorderElementColor />
                                     <MoveFocusHotKey>Tab</MoveFocusHotKey>
                                     <patientname>张三李四</patientname>
                                     <Name>病史陈述者</Name>
                                     <BackgroundText>病史陈述者</BackgroundText>
                                  </Element>
                                  <Element xsi:type="XParagraphFlag">
                                     <InnerID>256</InnerID>
                                  </Element>
                               </XElements>
                            </Element>
                         </XElements>
                      </Element>
                      <Element xsi:type="XTextTableRow">
                         <InnerID>257</InnerID>
                         <XElements>
                            <Element xsi:type="XTextTableCell" StyleIndex="7">
                               <InnerID>10</InnerID>
                               <XElements>
                                  <Element xsi:type="XString">
                                     <InnerID>388</InnerID>
                                     <Text> 发病节气：</Text>
                                  </Element>
                                  <Element xsi:type="XInputField">
                                     <InnerID>266</InnerID>
                                     <ID>发病季节</ID>
                                     <EnableValueValidate>true</EnableValueValidate>
                                     <BorderElementColor />
                                     <Name>发病节气</Name>
                                     <InnerValue>春季多发</InnerValue>
                                     <BackgroundText>发病节气</BackgroundText>
                                  </Element>
                                  <Element xsi:type="XParagraphFlag">
                                     <InnerID>267</InnerID>
                                  </Element>
                               </XElements>
                            </Element>
                            <Element xsi:type="XTextTableCell" StyleIndex="7">
                               <InnerID>11</InnerID>
                               <XElements>
                                  <Element xsi:type="XParagraphFlag">
                                     <InnerID>271</InnerID>
                                  </Element>
                               </XElements>
                            </Element>
                         </XElements>
                      </Element>
                   </XElements>
                   <Columns>
                      <Element xsi:type="XTextTableColumn">
                         <InnerID>110</InnerID>
                         <Width>937.375</Width>
                      </Element>
                      <Element xsi:type="XTextTableColumn">
                         <InnerID>111</InnerID>
                         <Width>957.375</Width>
                      </Element>
                   </Columns>
                </Element>
                <Element xsi:type="XParagraphFlag" StyleIndex="9">
                   <InnerID>273</InnerID>
                </Element>
                <Element xsi:type="XString">
                   <InnerID>373</InnerID>
                   <Text>                                                     医师签名：</Text>
                </Element>
                <Element xsi:type="XInputField">
                   <InnerID>333</InnerID>
                   <ID>医师签名</ID>
                   <EnableValueValidate>true</EnableValueValidate>
                   <BorderElementColor />
                   <MoveFocusHotKey>Tab</MoveFocusHotKey>
                   <SpecifyWidth>236.2205</SpecifyWidth>
                   <Name>医师签名</Name>
                   <BackgroundText>医师签名</BackgroundText>
                </Element>
                <Element xsi:type="XParagraphFlag" StyleIndex="9">
                   <InnerID>334</InnerID>
                </Element>
                <Element xsi:type="XParagraphFlag">
                   <InnerID>336</InnerID>
                </Element>
             </XElements>
          </Element>
          <Element xsi:type="XTextFooter">
             <InnerID>91</InnerID>
             <AcceptTab>true</AcceptTab>
             <XElements>
                <Element xsi:type="XString">
                   <InnerID>389</InnerID>
                   <Text>                                   第</Text>
                </Element>
                <Element xsi:type="XPageInfo">
                   <InnerID>93</InnerID>
                   <Width>85</Width>
                   <AutoHeight>true</AutoHeight>
                   <Height>62.7343674</Height>
                   <FormatString>[%PageIndex%]</FormatString>
                </Element>
                <Element xsi:type="XString">
                   <InnerID>390</InnerID>
                   <Text>页</Text>
                </Element>
                <Element xsi:type="XParagraphFlag">
                   <InnerID>95</InnerID>
                </Element>
             </XElements>
          </Element>
       </XElements>
       <SerializeParameterValue>true</SerializeParameterValue>
       <FileFormat>XML</FileFormat>
       <ContentStyles>
          <Default xsi:type="DocumentContentStyle">
             <FontName>宋体</FontName>
             <FontSize>12</FontSize>
          </Default>
          <Styles>
             <Style Index="0">
                <FontName>宋体</FontName>
                <FontSize>12</FontSize>
                <Align>Center</Align>
             </Style>
             <Style Index="1">
                <BackgroundColor>#00000000</BackgroundColor>
                <FontName>宋体</FontName>
                <FontSize>12</FontSize>
                <LineSpacingStyle>Space1pt5</LineSpacingStyle>
                <Align>Center</Align>
             </Style>
             <Style Index="2">
                <FontName>宋体</FontName>
                <FontSize>12</FontSize>
                <LineSpacingStyle>SpaceMultiple</LineSpacingStyle>
                <LineSpacing>1.2</LineSpacing>
                <Align>Center</Align>
             </Style>
             <Style Index="3">
                <FontName>宋体</FontName>
                <FontSize>12</FontSize>
                <LineSpacingStyle>SpaceMultiple</LineSpacingStyle>
                <LineSpacing>1.2</LineSpacing>
             </Style>
             <Style Index="4">
                <FontName>宋体</FontName>
                <FontSize>15</FontSize>
                <Bold>true</Bold>
                <Align>Center</Align>
             </Style>
             <Style Index="5">
                <FontName>宋体</FontName>
                <FontSize>12</FontSize>
                <BorderLeft>true</BorderLeft>
                <BorderBottom>true</BorderBottom>
                <BorderTop>true</BorderTop>
                <BorderRight>true</BorderRight>
             </Style>
             <Style Index="6">
                <FontName>宋体</FontName>
                <FontSize>18</FontSize>
                <Bold>true</Bold>
             </Style>
             <Style Index="7">
                <FontName>宋体</FontName>
                <FontSize>12</FontSize>
                <BorderWidth>1</BorderWidth>
                <PaddingLeft>15</PaddingLeft>
                <PaddingTop>10</PaddingTop>
                <PaddingRight>12.5</PaddingRight>
                <PaddingBottom>10</PaddingBottom>
             </Style>
             <Style Index="8">
                <FontName>宋体</FontName>
                <FontSize>10.5</FontSize>
             </Style>
             <Style Index="9">
                <FontName>宋体</FontName>
                <FontSize>12</FontSize>
                <LineSpacingStyle>Space1pt5</LineSpacingStyle>
             </Style>
             <Style Index="10">
                <FontName>宋体</FontName>
                <FontSize>12</FontSize>
                <LineSpacingStyle>Space1pt5</LineSpacingStyle>
                <Align>Center</Align>
             </Style>
          </Styles>
       </ContentStyles>
       <Info>
          <LicenseText>都昌:都昌旗舰版（100并发）</LicenseText>
          <CreationTime>1980-01-01T00:00:00</CreationTime>
          <LastModifiedTime>2023-08-30T16:20:01.0935127+08:00</LastModifiedTime>
          <LastPrintTime>1980-01-01T00:00:00</LastPrintTime>
          <Operator>DCSoft.Writer Version:1.2019.1.4</Operator>
          <NumOfPage>1</NumOfPage>
       </Info>
       <BodyText>入院记录

     姓名： 出生地：
     性别：   职业：
     年龄：岁 入院时间：
     民族：  记录时间：
     婚姻：   病史陈述者：
     发病节气：
                                                         医师签名：
</BodyText>
       <LocalConfig />
       <PageSettings>
          <LeftMargin>95</LeftMargin>
          <RightMargin>95</RightMargin>
          <StrictUsePageSize>false</StrictUsePageSize>
       </PageSettings>
</XTextDocument>`;
   </script>
</body>

</html>